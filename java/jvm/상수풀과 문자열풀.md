# Java Constant Pool, Runtime Constant Pool, String Pool 비교

## **1. Constant Pool (상수 풀)**

- **정의:** `.java` 소스 코드를 컴파일하여 생성된 `.class` 파일 내부에 존재하는 테이블 형태의 데이터 영역이다.
- **생성 시점:** 자바 코드를 컴파일하는 시점 (`javac`)에 생성된다.
- **특징:**
  - 해당 클래스에서 사용하는 모든 종류의 **상수 데이터와 심볼릭 참조(Symbolic Reference) 정보**를 담고 있습니다.
  - JVM이 클래스를 로딩하고 코드를 실행하는 데 필요한 핵심 정보를 제공합니다.
- **포함 내용:**
  - **리터럴 상수:** 코드에 직접 작성된 값 (`"hello"`, `10`, `3.14f` 등).
  - **심볼릭 참조(Symbolic Reference):** 아래와 같이 이름으로 표현된 모든 참조 정보.
    - 클래스 및 인터페이스의 이름 (`java/lang/Object`)
    - 필드의 이름과 타입 (`out`, `Ljava/io/PrintStream;`)
    - 메서드의 이름과 시그니처 (`println`, `(Ljava/lang/String;)`)

## **2. Runtime Constant Pool (런타임 상수 풀)**

- **정의:** JVM의 클래스 로더가 .class 파일을 로딩할 때, 그 안의 Constant Pool을 복제하여 <strong>메서드 영역(Method Area)</strong>에 생성하는 데이터 영역이다.
- **생성 시점:** 클래스 로딩 시점에 JVM에 의해 생성된다.
- **생성 단위:** JVM 전체에 하나만 있는 것이 아니라, **로드되는 클래스마다 하나씩 개별적으로 생성**된다.
- **위치:**
  - 논리적으로는 <strong>메서드 영역(Method Area)</strong>에 속한다.
  - 물리적으로는 (Java 8+ 기준) **OS의 네이티브 메모리(Native Memory)를 사용하는 Metaspace**에 저장된다.
- **주요 역할 및 특징:**
  - JVM이 코드를 실행하기 위해 참조를 연결하는 핵심 **작업 공간(Workspace)** 역할을 한다.
  - 이 공간에 있는 <strong>심볼릭 참조(Symbolic Reference)</strong>는 JVM에 의해 실제 메모리 주소(**직접 참조: Direct Reference**)로 **'해석(Resolution)'** 된다.
    > Linking의 해석 (Resolution) 단계
  - `new Object()`와 같이 런타임에 생성되는 객체는 포함하지 않지만, 해당 객체를 사용하는 **필드/메서드에 대한 심볼릭 참조는 포함**한다.
- 포함 내용:
  - Constant Pool의 모든 정보 (리터럴, 심볼릭 참조 등)가 그대로 올라온다.
  - 문자열 리터럴의 경우, 값 자체(`"hello"`)가 아닌 **String Intern Pool에 있는 객체를 가리키는 참조를 갖게 된다.**

## **3. String Pool (문자열 풀)**

- **정의:** JVM 내에서 문자열 리터럴을 효율적으로 관리하고 공유하기 위한 전용 메모리 공간이다.
- **생성 시점:** 런타임 시에 JVM에 의해 관리된다.
- **위치:** **힙 영역(Heap)** 내부에 존재한다. (Java 7부터 PermGen/Metaspace에서 힙 영역으로 이동)
- **특징:**
  - 동일한 내용의 문자열 리터럴은 이 공간에 **단 하나의 String 객체**로 생성되어 모든 곳에서 공유된다.
  - 이로 인해 `String s1 = "java";` `String s2 = "java";` 코드에서 `s1 == s2 `비교 결과는 `true`이다.
  - `String.intern()` 메서드를 통해 런타임에 생성된 문자열 객체도 명시적으로 이 풀에 추가하거나 가져올 수 있다.

## **✅ 최종 요약 비교표**

| 구분                      | 생성 시점      | 위치 (물리적, Java 8+)          | 생성 단위       | 주요 역할                                              | 문자열 리터럴                             |
| :------------------------ | :------------- | :------------------------------ | :-------------- | :----------------------------------------------------- | :---------------------------------------- |
| **Constant Pool**         | 컴파일시       | .class 파일                     | 클래스 파일마다 | 리터럴과 모든 심볼릭 참조를 **정적으로 저장**          | **정보 포함** (텍스트 값)                 |
| **Runtime Constant Pool** | 클래스 로딩 시 | **네이티브 메모리** (Metaspace) | **클래스마다**  | 심볼릭 참조를 실제 주소로 Resolution하는 **작업 공간** | **참조 포함** (String Pool 객체를 가리킴) |
| **String Pool**           | 런타임 시      | **힙(Heap)**                    | JVM 당 하나     | 공유되는 문자열 객체를 **실제로 저장하고 관리**        | **객체 포함** (실제 인스턴스)             |
